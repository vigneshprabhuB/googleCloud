package com.test.pol;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.util.List;
import java.io.FileReader;
import java.io.IOException;
import java.util.ArrayList;

public class Callerr {
	
	public static void main(String a[]) throws IOException {
		try{
		List<String> str=new ArrayList<String>();
		FileReader  io=new FileReader("F:\\ceids.txt");
		String ceId="";
		int ceIdByte=0;
		while((ceIdByte=io.read())!=-1){
			if(ceIdByte!=10){
				ceId=ceId+(char)ceIdByte;
		}
		if(ceIdByte==10){
			str.add(ceId);
			ceId="";
		}	
		}
		
		io.close();
		System.out.println(str);
		Class.forName("org.postgresql.Driver");
		Connection con=java.sql.DriverManager.getConnection("jdbc:postgresql:localhost:5432/SAMS/","postgres","admin");
		PreparedStatement ps=con.prepareStatement("INSERT INTO master.ceid values(?)");
		for(int i=0;i<str.size();i++){
		ps.setString(1, str.get(i));
		}
		ps.executeUpdate();
		}
		catch(Exception e){
			System.out.println(e);
		}
	finally{
		
	}	
	}
	}



